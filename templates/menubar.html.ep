<%# /templates/menubar.html.ep %>

<div class="navbar" style="display: flex; align-items: center; justify-content: space-between; padding-right: 20px; box-sizing: border-box;">   
    <div style="display: flex; align-items: center;">
        <button class="menu-btn" onclick="toggleMenu()">â˜°</button>
        <div style="margin-left: 20px; font-weight: bold; font-size: 1rem; color: #fff;">
            <%= title %>
        </div>
    </div>
    <a href="/" style="display: flex; align-items: center; opacity: 0.9;" title="Home">
        <img src="/files/serve/53" alt="Home" style="height: 32px; width: 32px; border-radius: 4px;">
    </a>
</div>

<div class="menu-overlay" id="menuOverlay" onclick="toggleMenu()"></div>

<div class="side-menu" id="sideMenu">
    <div class="menu-header">Menu</div>
    <% if (is_logged_in()) { %>
        <a href="/calendar">ğŸ“… Calendar</a>
        <a href="/shopping">ğŸ›’ Shopping List</a>
        <a href="<%= is_admin() ? '/timers/manage' : '/timers' %>" class="<%= (stash('current') // '') eq 'timers' ? 'active' : '' %>">â±ï¸ Timers</a>
        <a href="/birthdays">ğŸ‚ Birthdays</a>
        <a href="/swear">ğŸ¤¬ Swear Jar</a>
        <a href="javascript:void(0)" onclick="toggleGamesMenu()" style="display: flex; justify-content: space-between; align-items: center; cursor: pointer;">
            <span>ğŸ® Games</span>
            <span id="gamesArrow" style="font-size: 0.8em;">â–¼</span>
        </a>
        <div id="gamesSubmenu" style="display: none; background-color: rgba(0, 0, 0, 0.2); border-left: 3px solid #546e7a;">
            <a href="/imposter" style="padding-left: 25px;">ğŸ­ Imposter</a>
            <a href="/uno/lobby" style="padding-left: 25px;">ğŸƒ UNO</a>
            <a href="/connect4/lobby" style="padding-left: 25px;">ğŸ”´ Connect 4</a>
            <a href="/chess/lobby" style="padding-left: 25px;">â™Ÿï¸ Chess</a>
        </div>
        <a href="/p">ğŸ“ Phone Numbers</a>
        <a href="/quiz">ğŸ¦˜Citizenship Test</a>
    <% if (is_admin()) { %>
        <a href="/go" class="<%= (stash('current') // '') eq 'go' ? 'active' : '' %>">ğŸ”— Go Links</a>
        <a href="/copy">ğŸ“‹ Copy / Paste</a>
        <a href="/files">ğŸ“ Files</a>
    <% } %>
        <div style="margin-top: auto; border-top: 1px solid #333;"></div>
        <% if (is_admin()) { %>
            <a href="/users" style="color: #90caf9;">ğŸ‘¥ Admin: Users</a>
            <a href="/settings" style="color: #ffb74d;">âš™ï¸ Admin: Settings</a>
            <button class="menu-action text-red" onclick="startRestartSequence(event)">âš ï¸ Restart Server</button>
        <% } %>
        <a href="/logout" class="text-red">ğŸšª Logout</a>
    <% } else { %>
        <div style="margin-top: auto;"></div>
        <a href="/login" class="text-green">ğŸ”‘ Login</a>
        <a href="/register">ğŸ“ Register</a>
    <% } %>
</div>

<div id="restart-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>ğŸ”„ Server Restart</h3>
            <span class="close-modal" onclick="closeRestartModal()">&times;</span>
        </div>
        <div class="modal-body">
            <p>Initiating server restart...</p>
            <div class="spinner"></div>
        </div>
    </div>
</div>